// @flow

import React from 'react';
import { useState } from 'react';

import { Input } from 'antd';

import IconAssets from '../../assets/Icon/IconAssets';

import config from './TextInput.component.config';
import type { Props } from './TextInput.component.types';


/**
 * @param {boolean} error - check contain value on input
 * @param {string} label - to show label on the error message
 * @returns {React.Node} - return error if no input
 */
const showErrorMessage = (error: boolean, label: string) => (
  (error ?
    <div className="text-red-500 text-14px">{`${label} Cannot be Empty`}</div>
  : '')
);


/**
 *
 * @param {*} error - to check if the input error or not
 * @returns {string} - to give border color red style when error
 */
export const _inputBorderColor = (error: boolean) => {
  if (error) {
    return 'border-tp-red';
  }

  return '';
};


/**
 *
 * @param {*} props - props
 * @returns {React.Node} - node
 */
const _renderInput = (props: Props): React.Node => {
  const [error, setError] = useState(false);

  /**
   * @returns {void} - changing error state
   */
  const onBlur = (): void => {
    if (!props.value) {
      return setError(true);
    }

    return setError(false);
  };

  const errorBorderColor = error && props.required;

  return (
    <>
      <div className="text-14px">
        {`${props.label}`}
        {props.required && <span className="text-red-500">*</span>}
      </div>
      <Input
        value={props.value}
        placeholder={props.placeholder}
        onChange={props.onChange}
        maxLength={props.maxLength}
        disabled={props.disabled}
        prefix={<img src={IconAssets[props.icon]} width="16px" />}
        className={_inputBorderColor(errorBorderColor)}
        onBlur={onBlur}
      />
      {props.required && showErrorMessage(error, props.label)}
    </>
  );
};

/**
 * @param { Props } props - this is a prop types
 * @returns {React.Node} text input
 */
const TextInput = (props: Props): React.Node =>
 (
   <div className="w-3/12 flex flex-col items-start">
     {_renderInput(props)}
   </div>
  );


TextInput.defaultProps = config.defaultProps;

export default TextInput;
