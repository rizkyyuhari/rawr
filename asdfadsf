import { useState } from 'react';
import PropTypes from 'prop-types';

const RADIX_NUMBER = 10;
const TransactionForm = ({ handleAddTransaction }) => {
  const initialTransaction = { description: '', amount: '', type: 'withdraw' };
  const [transaction, setTransaction] = useState(initialTransaction);
  const handleInputChange = (event) => {
    setTransaction({ ...transaction, [event.target.name]: event.target.value });
  };

  const onSubmitHandler = async () => {
    const convertedTransaction = {
      ...transaction,
      amount: parseInt(transaction.amount, RADIX_NUMBER)
    };
    setTransaction(initialTransaction);
    await handleAddTransaction(convertedTransaction);
  };
  return (
    <form className="text-white mb-5 p-4 d-flex flex-column align-items-center border" onSubmit={onSubmitHandler}>
      <div className="mb-3">
        <label htmlFor="transaction-description" className="form-label">
          Description
          <input
            onChange={handleInputChange}
            type="text"
            maxLength="30"
            className="form-control"
            style={{ width: 300 }}
            id="transaction-description"
            aria-describedby="transactionDescription"
            name="description"
          />
        </label>
      </div>
      <div className="mb-3">
        <label htmlFor="transaction-amount" className="form-label">
          Amount
          <input
            onChange={handleInputChange}
            type="number"
            name="amount"
            className="form-control"
            style={{ width: 300 }}
            id="transaction-amount"
            aria-describedby="transactionAmount"
          />
        </label>
      </div>
      <div className="mb-3">
        <label className="input-group-text" htmlFor="transaction-type">
          Transaction Type
          <select className="form-select" name="type" id="transaction-type" onChange={handleInputChange} value={transaction.type}>
            <option value="withdraw">Withdraw</option>
            <option value="deposit">Deposit</option>
          </select>
        </label>
      </div>
      <button type="submit" className="btn btn-primary">
        Add Transaction
      </button>
    </form>
  );
};

TransactionForm.propTypes = {
  handleAddTransaction: PropTypes.func.isRequired
};

export default TransactionForm;


import userEvent from '@testing-library/user-event';
import { render } from '@testing-library/react';
import TransactionForm from '../../../src/pages/TransactionsPage/TransactionForm';

const mockHandleAddTransaction = jest.fn();
describe('TransactionForm', () => {
  beforeEach(() => {
    jest.clearAllMocks();
  });
  it('should trigger handler submit once when user inputted new transaction', async () => {
    const { getByLabelText, getByRole } = render(
      <TransactionForm
        handleAddTransaction={mockHandleAddTransaction}
      />
    );
    const user = userEvent.setup();
    const descriptionInput = getByLabelText('Description');
    const amountInput = getByLabelText('Amount');
    const selectType = getByLabelText('Transaction Type');
    const addTransactionButton = getByRole('button', { name: 'Add Transaction' });
    const description = 'buat beli rumah';
    const amount = 50968;
    const type = 'deposit';

    await user.type(descriptionInput, description);
    await user.type(amountInput, `${amount}`);
    await user.selectOptions(selectType, type);
    await user.click(addTransactionButton);

    expect(mockHandleAddTransaction).toHaveBeenNthCalledWith(
      1,
      {
        description,
        amount,
        type
      }
    );
  });
});
kenapa ada error     Error: Not implemented: HTMLFormElement.prototype.requestSubmit
